
<% 
    let splits = data.results.splits;
    splits.unshift(data.results.stats);
    let counter = 0;
%>

<div class="select-wrapper">
    <select id="sortIndex">
        <% splits.forEach(split => { %>    
            <option value="<%= counter %>"><%= split.abbreviation %></option>
            <% counter++;
        });
        counter = 0; %>
    </select>
</div>

<% splits.forEach(split => { %>

    <h3>Stats for: <%= split.abbreviation %></h3>

    <div id="<%= counter %>" class="filteredSection">

        <% split.categories.forEach(category => { %>

            <h2 class="importantHeadline"><%= category.displayName %></h2>

            <div class="tableDivide">
                <table>
                    <tr>
                        <% category.stats.forEach(stat => { %>
                            <th>
                                <div class="tooltip"><%= stat.abbreviation %>
                                    <span class="tooltip-text">
                                        <u><%= stat.displayName %></u>
                                        <br>
                                        <%= stat.description %>
                                    </span>
                                </div>
                            </th>
                        <% }) %>
                    </tr>
                    <tr>
                        <% category.stats.forEach(stat => { %>
                            <td><%= stat.displayValue %></td>
                        <% }) %>
                    </tr>
                </table>
            </div>
        <% }) %>
    </div>
<% counter++;
    }) %>

<script>

    //all the div elements 
    const divs = document.querySelectorAll('.filteredSection');
    divs.forEach(div => div.style.display = 'none');

    //the select element
    const filter = document.getElementById('sortIndex');

    //change visibility of tables when a new option is selected
    function selectDiv(){

        const selectedIndex = filter.value;

        divs.forEach(div => div.style.display = 'none');

        const selectedDiv = document.getElementById(selectedIndex);
        selectedDiv.style.display = 'block';
    }

    selectDiv();

    filter.addEventListener('change', selectDiv);

</script>
